<def-group oval_version="5.11">
  <definition class="compliance" id="smartcard_auth" version="1">
    <metadata>
      <title>Enable Smart Card Login</title>
      <affected family="unix">
        <platform>multi_platform_fedora</platform>
      </affected>
      <description>Enable Smart Card logins</description>
    </metadata>
      <criterion comment="smart card authentication is enabled with smartcard feature" test_ref="test_authselect_with_smartcard_enabled">
  </definition>

  <ind:textfilecontent54_test check="all" check_existence="all_exist"
  comment="Test if smartcard feature is enabled in authselect"
  id="test_authselect_with_smartcard_enabled" version="1">
    <ind:object object_ref="obj_authselect_with_smartcard_enabled" />
  </ind:textfilecontent54_test>
  <ind:textfilecontent54_object id="obj_use_kerberos_security_all_exports" version="1">
    <ind:filepath>/etc/authselect/authselect.conf</ind:filepath>
    <ind:pattern operation="pattern match">^sssd(?:[[:alpha:]]*\n)*with-smartcard</ind:pattern>
    <ind:instance datatype="int" operation="not equal">0</ind:instance>
  </ind:textfilecontent54_object>

</def-group>
