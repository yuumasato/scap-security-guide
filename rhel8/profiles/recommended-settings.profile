title: Hardening profile for Red Hat Enterprise Linux 8

description: 'This profile reflects mandatory configuration controls for
    Red Hat Enterprise Linux 8.'

documentation_complete: true
selections:
# rhel8_OSPP sub rhel7_CIS
- accounts_password_pam_dcredit
- accounts_password_pam_lcredit
- accounts_password_pam_minlen
- accounts_password_pam_ocredit
- accounts_password_pam_ucredit
- accounts_password_pam_unix_remember
- accounts_passwords_pam_faillock_deny
- accounts_passwords_pam_faillock_unlock_time
- no_empty_passwords
- sudo_remove_nopasswd
- sudo_remove_no_authenticate
- sudo_require_authentication
- accounts_umask_etc_bashrc
- accounts_umask_etc_profile
- banner_etc_issue
- disable_host_auth
- disable_users_coredumps
- ensure_gpgcheck_globally_activated
- ensure_redhat_gpgkey_installed
- zipl_audit_argument
- zipl_audit_backlog_limit_argument
- kernel_module_dccp_disabled
- kernel_module_rds_disabled
- kernel_module_tipc_disabled
- kernel_module_cramfs_disabled
- kernel_module_sctp_disabled
- kernel_module_tipc_disabled
- kernel_module_vfat_disabled
- kernel_module_squashfs_disabled
- kernel_module_udf_disabled
- mount_option_dev_shm_nodev
- mount_option_dev_shm_noexec
- mount_option_dev_shm_nosuid
- mount_option_home_nodev
- mount_option_tmp_nodev
- mount_option_tmp_noexec
- mount_option_tmp_nosuid
- mount_option_var_tmp_nodev
- mount_option_var_tmp_noexec
- mount_option_var_tmp_nosuid
- mount_option_boot_nodev
- mount_option_boot_nosuid
- mount_option_home_nosuid
- mount_option_var_log_audit_nodev
- mount_option_var_log_audit_noexec
- mount_option_var_log_audit_nosuid
- mount_option_var_log_nodev
- mount_option_var_log_noexec
- mount_option_var_log_nosuid
- mount_option_var_nodev
- package_aide_installed
- partition_for_home
- partition_for_var
- partition_for_var_log
- partition_for_var_log_audit
- require_singleuser_auth
- selinux_policytype
- selinux_state
- zipl_enable_selinux
- service_auditd_enabled
- sshd_disable_empty_passwords
- sshd_disable_root_login
- sshd_enable_warning_banner
- sshd_set_idle_timeout
- sshd_set_keepalive
- sshd_disable_gssapi_auth
- sshd_disable_kerb_auth
- sshd_enable_strictmodes
- sshd_rekey_limit
- sshd_use_priv_separation
- sshd_do_not_permit_user_env
- sshd_disable_rhosts
- sshd_set_loglevel_info
- sshd_disable_user_known_hosts
- sysctl_kernel_randomize_va_space
- sysctl_kernel_exec_shield
- sysctl_kernel_kptr_restrict
- sysctl_kernel_dmesg_restrict
- sysctl_kernel_kexec_load_disabled
- sysctl_kernel_yama_ptrace_scope
- sysctl_kernel_unprivileged_bpf_disabled
- sysctl_net_core_bpf_jit_harden
- sysctl_net_ipv4_conf_all_accept_redirects
- sysctl_net_ipv4_conf_all_accept_source_route
- sysctl_net_ipv4_conf_all_log_martians
- sysctl_net_ipv4_conf_all_rp_filter
- sysctl_net_ipv4_conf_all_secure_redirects
- sysctl_net_ipv4_conf_all_send_redirects
- sysctl_net_ipv4_conf_default_accept_redirects
- sysctl_net_ipv4_conf_default_accept_source_route
- sysctl_net_ipv4_conf_default_log_martians
- sysctl_net_ipv4_conf_default_rp_filter
- sysctl_net_ipv4_conf_default_secure_redirects
- sysctl_net_ipv4_conf_default_send_redirects
- sysctl_net_ipv4_icmp_echo_ignore_broadcasts
- sysctl_net_ipv4_icmp_ignore_bogus_error_responses
- sysctl_net_ipv4_ip_forward
- sysctl_net_ipv4_tcp_syncookies
- sysctl_net_ipv6_conf_all_accept_ra
- sysctl_net_ipv6_conf_all_accept_redirects
- sysctl_net_ipv6_conf_default_accept_ra
- sysctl_net_ipv6_conf_default_accept_redirects
- var_password_pam_unix_remember=5
- var_selinux_state=enforcing
- var_selinux_policy_name=targeted
- var_password_pam_ocredit=1
- var_password_pam_dcredit=1
- var_password_pam_ucredit=1
- var_password_pam_lcredit=1

# From rhel8 OSPP
- configure_crypto_policy
- var_system_crypto_policy=default_nosha1
- coredump_disable_backtraces
- coredump_disable_storage
- grub2_audit_backlog_limit_argument
- package_audit_installed
- package_firewalld_installed
- service_firewalld_enabled
- sysctl_net_ipv6_conf_all_accept_source_route
- sysctl_net_ipv6_conf_default_accept_source_route
- var_sshd_set_keepalive=0

# Configure dnf-automatic to Install Only Security Updates
- dnf-automatic_apply_updates
- dnf-automatic_security_updates_only

# reduction of attack surface
- package_setroubleshoot_removed
- package_xinetd_removed
- package_xorg-x11-server-common_removed
- package_squid_removed
- package_ypbind_removed
- package_telnet_removed
- package_openldap-clients_removed

- service_autofs_disabled
- service_rsyncd_disabled
- service_avahi-daemon_disabled
- service_snmpd_disabled
- service_smb_disabled
- service_dovecot_disabled
- service_httpd_disabled
- service_vsftpd_disabled
- service_named_disabled
- service_nfs_disabled
- service_rpcbind_disabled
- service_dhcpd_disabled
- service_cups_disabled

- file_owner_etc_passwd
- file_groupowner_etc_passwd
- file_permissions_etc_passwd
- file_owner_etc_shadow
- file_groupowner_etc_shadow
- file_permissions_etc_shadow
- file_owner_etc_group
- file_groupowner_etc_group
- file_permissions_etc_group
- file_owner_etc_gshadow
- file_groupowner_etc_gshadow
- file_permissions_etc_gshadow
- file_permissions_unauthorized_suid
- file_permissions_unauthorized_sgid
- rpm_verify_permissions
- rpm_verify_ownership
